from transformers import pipeline

def analyze_with_ai(data):
    # Inicializa o pipeline com um modelo pré-treinado
    generator = pipeline('text-generation', model='gpt2')
    
    # Define o prompt com as informações fornecidas
    prompt = f"""
    Baseado nos fatores fornecidos, analise o risco de reincidência criminal:
    - Nome: {data['name']}
    - Idade: {data['age']}
    - Gênero: {data['gender']}
    - Crimes Anteriores: {data.get('previous_crimes', 'Não informado')}
    - Fatores Sociológicos: {data.get('sociological_factors', 'Não fornecido')}
    - Fatores Psicológicos: {data.get('psychological_factors', 'Não fornecido')}
    - Fatores Culturais: {data.get('cultural_factors', 'Não fornecido')}
    - Fatores Individuais: {data.get('individual_factors', 'Não fornecido')}

    Gere uma pontuação de risco entre 0 e 100 e justifique os fatores que contribuíram para essa pontuação.
    """
    
    # Gera a análise com base no prompt
    response = generator(prompt, max_length=500)
    return response[0]['generated_text'].strip()
